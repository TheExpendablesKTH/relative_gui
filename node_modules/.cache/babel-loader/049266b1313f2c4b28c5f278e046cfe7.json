{"ast":null,"code":"\"use strict\"; // Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Implements the [Full Jitter algorithm](\n * https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/)\n * and also allows for specifying a fixed wait added to the full jitter backoff\n * (which can be zero).\n */\n\nclass FullJitterBackoff {\n  constructor(fixedWaitMs, shortBackoffMs, longBackoffMs) {\n    this.fixedWaitMs = fixedWaitMs;\n    this.shortBackoffMs = shortBackoffMs;\n    this.longBackoffMs = longBackoffMs;\n    this.currentRetry = 0;\n\n    if (this.fixedWaitMs < 0) {\n      this.fixedWaitMs = 0;\n    }\n\n    if (this.shortBackoffMs < 0) {\n      this.shortBackoffMs = 0;\n    }\n\n    if (this.longBackoffMs < 0) {\n      this.longBackoffMs = 0;\n    }\n\n    this.reset();\n  }\n\n  reset() {\n    this.currentRetry = 0;\n  }\n\n  nextBackoffAmountMs() {\n    const fullJitterMs = Math.random() * Math.min(this.longBackoffMs, this.shortBackoffMs * Math.pow(2.0, this.currentRetry)) + this.fixedWaitMs;\n    this.currentRetry += 1;\n    return fullJitterMs;\n  }\n\n}\n\nexports.default = FullJitterBackoff;","map":{"version":3,"sources":["../../src/backoff/FullJitterBackoff.ts"],"names":[],"mappings":"cAAA;AACA;;;;;AAIA;;;;;AAKG;;AACH,MAAqB,iBAArB,CAAsC;AAGpC,EAAA,WAAA,CACU,WADV,EAEU,cAFV,EAGU,aAHV,EAG+B;AAFrB,SAAA,WAAA,GAAA,WAAA;AACA,SAAA,cAAA,GAAA,cAAA;AACA,SAAA,aAAA,GAAA,aAAA;AALF,SAAA,YAAA,GAAuB,CAAvB;;AAON,QAAI,KAAK,WAAL,GAAmB,CAAvB,EAA0B;AACxB,WAAK,WAAL,GAAmB,CAAnB;AACD;;AACD,QAAI,KAAK,cAAL,GAAsB,CAA1B,EAA6B;AAC3B,WAAK,cAAL,GAAsB,CAAtB;AACD;;AACD,QAAI,KAAK,aAAL,GAAqB,CAAzB,EAA4B;AAC1B,WAAK,aAAL,GAAqB,CAArB;AACD;;AACD,SAAK,KAAL;AACD;;AAED,EAAA,KAAK,GAAA;AACH,SAAK,YAAL,GAAoB,CAApB;AACD;;AAED,EAAA,mBAAmB,GAAA;AACjB,UAAM,YAAY,GAChB,IAAI,CAAC,MAAL,KACE,IAAI,CAAC,GAAL,CAAS,KAAK,aAAd,EAA6B,KAAK,cAAL,GAAsB,IAAI,CAAC,GAAL,CAAS,GAAT,EAAc,KAAK,YAAnB,CAAnD,CADF,GAEA,KAAK,WAHP;AAIA,SAAK,YAAL,IAAqB,CAArB;AACA,WAAO,YAAP;AACD;;AA/BmC;;AAAtC,OAAA,CAAA,OAAA,GAAA,iBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Implements the [Full Jitter algorithm](\n * https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/)\n * and also allows for specifying a fixed wait added to the full jitter backoff\n * (which can be zero).\n */\nclass FullJitterBackoff {\n    constructor(fixedWaitMs, shortBackoffMs, longBackoffMs) {\n        this.fixedWaitMs = fixedWaitMs;\n        this.shortBackoffMs = shortBackoffMs;\n        this.longBackoffMs = longBackoffMs;\n        this.currentRetry = 0;\n        if (this.fixedWaitMs < 0) {\n            this.fixedWaitMs = 0;\n        }\n        if (this.shortBackoffMs < 0) {\n            this.shortBackoffMs = 0;\n        }\n        if (this.longBackoffMs < 0) {\n            this.longBackoffMs = 0;\n        }\n        this.reset();\n    }\n    reset() {\n        this.currentRetry = 0;\n    }\n    nextBackoffAmountMs() {\n        const fullJitterMs = Math.random() *\n            Math.min(this.longBackoffMs, this.shortBackoffMs * Math.pow(2.0, this.currentRetry)) +\n            this.fixedWaitMs;\n        this.currentRetry += 1;\n        return fullJitterMs;\n    }\n}\nexports.default = FullJitterBackoff;\n//# sourceMappingURL=FullJitterBackoff.js.map"]},"metadata":{},"sourceType":"script"}